{"ast":null,"code":"import _slicedToArray from \"D:\\\\Ty\\xF6\\\\Vitec\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\Ty\\xF6\\\\Vitec\\\\client\\\\src\\\\dynamictable\\\\dynamictable.js\";\n\nimport React, { useState, Fragment } from \"react\";\nimport \"./dynamictable.css\";\nimport schema from \"../template\";\nimport Axios from 'axios';\nvar schemaAsObject = JSON.parse(schema);\n\nvar DynamicTable = function DynamicTable(_ref) {\n  var sqlData = _ref.sqlData;\n\n  var deleteElement = function deleteElement(id) {\n    Axios.post(\"http://localhost:3001/deleteelement/\".concat(id), {\n      template: schemaAsObject\n    }).then(function (response) {\n      alert(response.data);\n    });\n  };\n\n  var saveElement = function saveElement(id) {\n    Axios.post(\"http://localhost:3001/editelement/\".concat(id), {\n      template: schemaAsObject,\n      data: editFormData\n    }).then(function (response) {\n      alert(response.data);\n    });\n  };\n\n  var columns = [];\n\n  for (var i in schemaAsObject.properties) {\n    columns.push(i);\n  }\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      editElementID = _useState2[0],\n      setEditElementID = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      editFormData = _useState4[0],\n      setEditFormData = _useState4[1];\n\n  var handleEditClick = function handleEditClick(event, index) {\n    event.preventDefault();\n    setEditFormData(sqlData[index]);\n    setEditElementID(index);\n  };\n\n  var handleFormChange = function handleFormChange(event) {\n    var fieldName = event.target.id;\n    var fieldValue = event.target.value;\n\n    if (event.target.type === \"checkbox\") {\n      fieldValue = event.target.checked;\n    }\n\n    var newFormData = editFormData;\n    newFormData[fieldName] = fieldValue;\n    console.log(newFormData);\n    setEditFormData(newFormData);\n  };\n\n  var handleSaveClick = function handleSaveClick(event, item) {\n    event.preventDefault();\n    saveElement(item.id);\n    setEditElementID(null);\n  };\n\n  var EditType = function EditType(item) {\n    if (schemaAsObject.properties[item[\"item\"]].hasOwnProperty(\"enum\")) {\n      var a = [];\n\n      for (var _i in schemaAsObject.properties[item[\"item\"]].enum) {\n        a.push(schemaAsObject.properties[item[\"item\"]].enum[_i]);\n      }\n\n      return /*#__PURE__*/React.createElement(\"select\", {\n        id: item[\"item\"],\n        onChange: function onChange(event) {\n          return handleFormChange(event);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 22\n        }\n      }, a.map(function (opt) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: opt,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 39\n          }\n        }, \" \", opt, \" \");\n      }));\n    } else if (schemaAsObject.properties[item[\"item\"]].type === \"boolean\") {\n      return /*#__PURE__*/React.createElement(\"input\", {\n        id: item[\"item\"],\n        type: \"checkbox\",\n        onClick: function onClick(event) {\n          return handleFormChange(event);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 20\n        }\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(\"input\", {\n        id: item[\"item\"],\n        type: \"text\",\n        onChange: function onChange(event) {\n          return handleFormChange(event);\n        },\n        value: item,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 20\n        }\n      });\n    }\n  };\n\n  var ColumnName = function ColumnName(_ref2) {\n    var item = _ref2.item;\n    return /*#__PURE__*/React.createElement(\"th\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 36\n      }\n    }, item);\n  };\n\n  var ColumnValues = function ColumnValues(_ref3) {\n    var item = _ref3.item,\n        columns = _ref3.columns,\n        index = _ref3.index;\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }\n    }, columns.map(function (columnName) {\n      return /*#__PURE__*/React.createElement(\"td\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 24\n        }\n      }, \" \", item[\"\".concat(columnName)], \" \");\n    }), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: function onClick(event) {\n        return handleEditClick(event, index);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }\n    }, \"Edit\")), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: function onClick() {\n        deleteElement(item.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }\n    }, \"Delete\")));\n  };\n\n  var ColumnEdit = function ColumnEdit(_ref4) {\n    var item = _ref4.item,\n        columns = _ref4.columns;\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }\n    }, columns.map(function (item) {\n      return /*#__PURE__*/React.createElement(\"td\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(EditType, {\n        item: item,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }\n      }));\n    }), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: function onClick(event) {\n        return handleSaveClick(event, item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"Save changes\")), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: function onClick(event) {\n        return handleEditClick(event, null);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }, \"Cancel changes\")));\n  };\n\n  return /*#__PURE__*/React.createElement(\"form\", {\n    id: \"table\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, schemaAsObject.tablename)), /*#__PURE__*/React.createElement(\"table\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 21\n    }\n  }, columns.map(function (item, index) {\n    return /*#__PURE__*/React.createElement(ColumnName, {\n      item: item,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 55\n      }\n    });\n  }))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 17\n    }\n  }, sqlData.map(function (item, index) {\n    return /*#__PURE__*/React.createElement(Fragment, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 25\n      }\n    }, editElementID === index ? /*#__PURE__*/React.createElement(ColumnEdit, {\n      item: item,\n      columns: columns,\n      index: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 29\n      }\n    }) : /*#__PURE__*/React.createElement(ColumnValues, {\n      item: item,\n      columns: columns,\n      index: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 29\n      }\n    }));\n  }))));\n};\n\nexport default DynamicTable;","map":{"version":3,"sources":["D:/TyÃ¶/Vitec/client/src/dynamictable/dynamictable.js"],"names":["React","useState","Fragment","schema","Axios","schemaAsObject","JSON","parse","DynamicTable","sqlData","deleteElement","id","post","template","then","response","alert","data","saveElement","editFormData","columns","i","properties","push","editElementID","setEditElementID","setEditFormData","handleEditClick","event","index","preventDefault","handleFormChange","fieldName","target","fieldValue","value","type","checked","newFormData","console","log","handleSaveClick","item","EditType","hasOwnProperty","a","enum","map","opt","ColumnName","ColumnValues","columnName","ColumnEdit","tablename"],"mappings":"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","sourcesContent":["import React, {useState, Fragment} from \"react\";\r\nimport \"./dynamictable.css\"\r\nimport schema from \"../template\"\r\nimport Axios from 'axios'\r\n\r\nconst schemaAsObject = JSON.parse(schema);\r\n\r\nconst DynamicTable = ({sqlData}) => {\r\n\r\n    const deleteElement = (id) => {\r\n        Axios.post(`http://localhost:3001/deleteelement/${id}`, {template: schemaAsObject}).then((response) => {\r\n            alert(response.data)\r\n        })\r\n    }\r\n    \r\n    const saveElement = (id) => {\r\n        Axios.post(`http://localhost:3001/editelement/${id}`, {template: schemaAsObject, data: editFormData}).then((response) => {\r\n            alert(response.data)\r\n        })\r\n    }\r\n\r\n    let columns = []\r\n    for(let i in schemaAsObject.properties){\r\n        columns.push(i)\r\n    }\r\n\r\n    const [editElementID, setEditElementID] = useState(null)\r\n    const [editFormData, setEditFormData] = useState(null)\r\n\r\n    const handleEditClick = (event, index) => {\r\n        event.preventDefault()\r\n        setEditFormData(sqlData[index])\r\n        setEditElementID(index)\r\n    }\r\n\r\n    const handleFormChange = (event) => {\r\n        \r\n        const fieldName = event.target.id\r\n        let fieldValue = event.target.value\r\n        if(event.target.type === \"checkbox\"){\r\n            fieldValue = event.target.checked\r\n        }\r\n        let newFormData = editFormData\r\n        newFormData[fieldName] = fieldValue\r\n        console.log(newFormData)\r\n        setEditFormData(newFormData)\r\n        \r\n    }\r\n\r\n    const handleSaveClick = (event, item) => {\r\n        event.preventDefault()\r\n        saveElement(item.id)\r\n        setEditElementID(null)\r\n    }\r\n\r\n    const EditType = (item) => {\r\n        if(schemaAsObject.properties[item[\"item\"]].hasOwnProperty(\"enum\")){   \r\n            const a = []\r\n            for(let i in schemaAsObject.properties[item[\"item\"]].enum){\r\n                a.push(schemaAsObject.properties[item[\"item\"]].enum[i])\r\n            }\r\n            return  (<select id={item[\"item\"]} onChange={(event) => handleFormChange(event)}>\r\n                        {a.map(opt => <option key={opt}> {opt} </option>)}\r\n                    </select>)\r\n        }else if(schemaAsObject.properties[item[\"item\"]].type === \"boolean\"){\r\n            return <input id={item[\"item\"]} type = \"checkbox\" onClick={(event) => handleFormChange(event)}/>\r\n        }else{\r\n            return <input id={item[\"item\"]} type = \"text\" onChange={(event) => handleFormChange(event)} value={item}/>\r\n        }\r\n    }\r\n\r\n    const ColumnName = ({item}) => <th>{item}</th>\r\n    const ColumnValues = ({item, columns, index}) => (\r\n        <tr>\r\n            {columns.map((columnName) => {\r\n                return <td> {item[`${columnName}`]} </td>\r\n            })}\r\n            <td>\r\n                <button onClick={(event) => handleEditClick(event, index)}>Edit</button>\r\n            </td>\r\n            <td>\r\n                <button onClick = {() => {deleteElement(item.id)}}>Delete</button>\r\n            </td>\r\n        </tr>\r\n    )\r\n    const ColumnEdit = ({item, columns}) => (\r\n        <tr>\r\n            {columns.map((item) => (\r\n                <td><EditType item = {item}/></td>\r\n            ))}\r\n            <td>\r\n                <button onClick={(event) => handleSaveClick(event, item)}>Save changes</button>\r\n            </td>\r\n            <td>\r\n                <button onClick={(event) => handleEditClick(event, null)}>Cancel changes</button>\r\n            </td>\r\n        </tr>\r\n    )\r\n\r\n    return (\r\n        <form id=\"table\">\r\n            <div>\r\n                <h1>{schemaAsObject.tablename}</h1>\r\n            </div>\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        {columns.map((item, index) => <ColumnName item = {item}/>)}\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {sqlData.map((item, index) => (\r\n                        <Fragment>\r\n                            {editElementID === index ? (\r\n                            <ColumnEdit item = {item} columns = {columns} index = {index}/>) : (\r\n                            <ColumnValues item = {item} columns = {columns} index = {index}/>)}\r\n                        </Fragment>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </form>\r\n    )\r\n}\r\n\r\nexport default DynamicTable;"]},"metadata":{},"sourceType":"module"}